{
    "contents" : "# TFBindingSiteSearch.R\n\n# load libraries\nlibrary(\"JASPAR2014\")\nlibrary(\"Biostrings\")\nlibrary(\"BSgenome.Cfamiliaris.UCSC.canFam3\")\nlibrary(\"TFBSTools\")\n\ngenome <- BSgenome.Cfamiliaris.UCSC.canFam3\nseqlevels(genome) <- gsub(\"chr\", \"\", seqlevels(genome))\n\n#----------searching for AP-1 sites-----------------------------\n# Using pattern matching to find putative AP-1 binding sites\n# ap1Motif <- DNAString(\"ATGAGTCAT\")\n# m1 <- matchPattern(ap1Motif, genome$\"1\", max.mismatch = 1)\n# gr.ap1Sites <- GRanges(seqnames = \"1\", as(m1, \"IRanges\"))\n# subsetByOverlaps(gr.which.tss.nostrand, gr.ap1Sites)\n\n# AP-1 is a heterodimeric protein, consisting of c-Jun/c-Fos/ATF/JDP families\n# JASPAR contains matrices (all human)\n# c-Jun - MA0488.1\n# c-Fos - MA0476.1\n# Atf1_1 - PB0004.1\n# Atf1_2 - PB0108.1\nopts <- list()\nopts[[\"ID\"]] = c(\"MA0488.1\", \"MA0476.1\", \"PB0004.1\", \"PB0108.1\")\nopts[[\"name\"]] = \"NFKB1\"\nopts[[\"all_versions\"]] = TRUE\nPFMatrixList <- getMatrixSet(JASPAR2014, opts = opts)\npwmList <- PWMatrixList(MA0488.1 = toPWM(PFMatrixList[[\"MA0488.1\"]]), \n                        MA0476.1 = toPWM(PFMatrixList[[\"MA0476.1\"]]), \n                        PB0004.1 = toPWM(PFMatrixList[[\"PB0004.1\"]]),\n                        PB0108.1 = toPWM(PFMatrixList[[\"PB0108.1\"]]), \n                        use.names = TRUE)\n\ngrl.ap1Sites <- GRangesList(sapply(seqlevels(gr.which), function(x){\n  subject <- genome[[as(x, \"character\")]]\n  sitesetList <- searchSeq(pwmList, subject, seqname = as(x, \"character\"), min.score = \"95%\", strand = \"*\") \n  gr.ap1Sites <- c(as(sitesetList[[1]], \"GRanges\"),\n                   as(sitesetList[[2]], \"GRanges\"), \n                   as(sitesetList[[3]], \"GRanges\"),\n                   as(sitesetList[[4]], \"GRanges\"))\n  return(gr.ap1Sites)\n})\n)\n\ngr.ap1Sites <- unlist(grl.ap1Sites)\ngr.ap1Sites <- sort(gr.ap1Sites)\ngr.ap1Sites <- reduce(gr.ap1Sites)\n# extend CDS by 10kb\naT.ap1Sites <- AnnotationTrack(subsetByOverlaps(gr.ap1Sites, gr.which), name = \"AP1\", col = \"blue\")\n\ndisplayPars(aT.ap1Sites) <- list(\"fontcolor.title\" = \"black\", \n                                 \"background.title\" = \"white\", \n                                 \"col.axis\" = \"black\", \n                                 \"col.frame\" = \"white\",\n                                 cex.title = 0.5,\n                                 rotation.title = 0)\n\n#----------searching for NFKB sites-----------------------------------\n# NFKB1 (4 specie consensus) - MA0105.1\n# NFKB1 (human) - MA0105.2\n# NFKB1 (human) - MA0105.3\nopts <- list()\nopts[[\"ID\"]] = c(\"MA0105.1\", \"MA0105.2\", \"MA0105.3\")\nopts[[\"name\"]] = \"NFKB1\"\nopts[[\"all_versions\"]] = TRUE\nPFMatrixList <- getMatrixSet(JASPAR2014, opts = opts)\npwmList <- PWMatrixList(MA0105.1 = toPWM(PFMatrixList[[\"MA0105.1\"]]),\n                        MA0105.2 = toPWM(PFMatrixList[[\"MA0105.2\"]]),\n                        MA0105.3 = toPWM(PFMatrixList[[\"MA0105.3\"]]), \n                        use.names = TRUE)\n\ngrl.nfkbSites <- GRangesList(sapply(seqlevels(gr.which), function(x){\n  subject <- genome[[as(x, \"character\")]]\n  sitesetList <- searchSeq(pwmList, subject, seqname = as(x, \"character\"), min.score = \"95%\", strand = \"*\") \n  gr.nfkbSites <- c(as(sitesetList[[1]], \"GRanges\"),\n                   as(sitesetList[[2]], \"GRanges\"), \n                   as(sitesetList[[3]], \"GRanges\"))\n  return(gr.nfkbSites)\n}))\n\ngr.nfkbSites <- unlist(grl.nfkbSites)\ngr.nfkbSites <- sort(gr.nfkbSites)\ngr.nfkbSites <- reduce(gr.nfkbSites)\naT.nfkbSites <- AnnotationTrack(subsetByOverlaps(gr.nfkbSites, gr.which), name = \"NFKB\", col = \"salmon\")\n\ndisplayPars(aT.nfkbSites) <- list(\"fontcolor.title\" = \"black\", \n                                  \"background.title\" = \"white\", \n                                  \"col.axis\" = \"black\", \n                                  \"col.frame\" = \"white\",\n                                  cex.title = 0.5,\n                                  rotation.title = 0)\n\nsave(aT.ap1Sites, file = \"~/Data/Tremethick/EMT/GenomeWide/danpos_analysis/aT.ap1Sites.rda\")\nsave(aT.nfkbSites, file = \"~/Data/Tremethick/EMT/GenomeWide/danpos_analysis/aT.nfkbSites.rda\")\n\n\n\n",
    "created" : 1450154535318.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1564974568",
    "id" : "4707AD3A",
    "lastKnownWriteTime" : 1450154740,
    "path" : "~/OneDrive/Development/JCSMR_Genomics/R/TremethickLab/H2AZ_EMT/TFBindingSiteSearch.R",
    "project_path" : "TFBindingSiteSearch.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}